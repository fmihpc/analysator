

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plot &mdash; analysator  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=187304be"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about/" />
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="calculations" href="../calculations/" />
    <link rel="prev" title="Analysator supported data reducers and vlasiator variables" href="../analysator_supported/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            analysator
              <img src="../_static/logo_color.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../analysator/">Introduction to Analysator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysator_exercises/">Analysator exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysator_supported/">Analysator supported data reducers and vlasiator variables</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysator reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">plot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_colormap"><code class="docutils literal notranslate"><span class="pre">plot_colormap()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_colormap3dslice"><code class="docutils literal notranslate"><span class="pre">plot_colormap3dslice()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_ionosphere"><code class="docutils literal notranslate"><span class="pre">plot_ionosphere()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_isosurface"><code class="docutils literal notranslate"><span class="pre">plot_isosurface()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_multiple_variables"><code class="docutils literal notranslate"><span class="pre">plot_multiple_variables()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_neutral_sheet"><code class="docutils literal notranslate"><span class="pre">plot_neutral_sheet()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_threeslice"><code class="docutils literal notranslate"><span class="pre">plot_threeslice()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_variables"><code class="docutils literal notranslate"><span class="pre">plot_variables()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_vdf"><code class="docutils literal notranslate"><span class="pre">plot_vdf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_vdf_profiles"><code class="docutils literal notranslate"><span class="pre">plot_vdf_profiles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysator.plot.plot_vdfdiff"><code class="docutils literal notranslate"><span class="pre">plot_vdfdiff()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../calculations/">calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vlsvfile/">vlsvfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/">miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/">scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">analysator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">plot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/plot.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-analysator.plot">
<span id="plot"></span><h1>plot<a class="headerlink" href="#module-analysator.plot" title="Link to this heading">ÔÉÅ</a></h1>
<p>The plot module has all the functions related to plotting variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example:</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">analysator</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pt</span>
<span class="n">pt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span>
<span class="c1">#press [tab] -&gt; get the functions</span>
</pre></div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_colormap">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_colormap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usesci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internalcb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noborder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noxlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noylabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxthick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxlinecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsaved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nomask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Earth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectordensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorcolormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinedensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinethick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useimshow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imshowinterp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flipxaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_colormap" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a coloured plot with axes and a colour bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final part will be used as a prefix for the files.</p>
</dd>
<dt class="field-even">Kword outputfile<span class="colon">:</span></dt>
<dd class="field-even"><p>Singular output file name</p>
</dd>
<dt class="field-odd">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-even">Kword var<span class="colon">:</span></dt>
<dd class="field-even"><p>variable to plot, e.g. rho, RhoBackstream, beta, Temperature, MA, Mms, va, vms,
E, B, v, V or others. Accepts any variable known by analysator.
Per-population variables are simply given as ‚Äúproton/rho‚Äù etc</p>
</dd>
<dt class="field-odd">Kword operator<span class="colon">:</span></dt>
<dd class="field-odd"><p>Operator to apply to variable: None, x, y, or z. Vector variables return either
the queried component, or otherwise the magnitude.</p>
</dd>
<dt class="field-even">Kword op<span class="colon">:</span></dt>
<dd class="field-even"><p>duplicate of operator</p>
</dd>
<dt class="field-odd">Kword boxm<span class="colon">:</span></dt>
<dd class="field-odd"><p>zoom box extents [x0,x1,y0,y1] in metres (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-even">Kword boxre<span class="colon">:</span></dt>
<dd class="field-even"><p>zoom box extents [x0,x1,y0,y1] in Earth radii (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-odd">Kword colormap<span class="colon">:</span></dt>
<dd class="field-odd"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-even">Kword run<span class="colon">:</span></dt>
<dd class="field-even"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-odd">Kword title<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-even">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as colorbar title instead of map name</p>
</dd>
<dt class="field-odd">Kword axisunit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot axes using 10^{axisunit} m (default: Earth radius R_E)</p>
</dd>
<dt class="field-even">Kword tickinterval<span class="colon">:</span></dt>
<dd class="field-even"><p>Interval at which to have ticks on axes (not colorbar)</p>
</dd>
<dt class="field-odd">Kwird usesci<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use scientific notation for colorbar ticks? (default: True)</p>
</dd>
<dt class="field-even">Kword vmin,vmax<span class="colon">:</span></dt>
<dd class="field-even"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot (non-zero rho regions only) are used.</p>
</dd>
<dt class="field-odd">Kword symmetric<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set the absolute value of vmin and vmax to the greater of the two</p>
</dd>
<dt class="field-even">Kword lin<span class="colon">:</span></dt>
<dd class="field-even"><p>Flag for using linear colour scaling instead of log. If an integer, defines number
of colorbar ticks.</p>
</dd>
<dt class="field-odd">Kword symlog<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use logarithmic scaling, but linear when abs(value) is below the value given to symlog.
Allows symmetric quasi-logarithmic plots of e.g. transverse field components.
A given of 0 or True translates to a threshold of max(abs(vmin),abs(vmax)) * 1.e-2, but this can
result in the innermost tick marks overlapping. In this case, using a larger value for 
symlog is suggested.</p>
</dd>
<dt class="field-even">Kword wmark<span class="colon">:</span></dt>
<dd class="field-even"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-odd">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-odd"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
<dt class="field-even">Kword Earth<span class="colon">:</span></dt>
<dd class="field-even"><p>If set, draws an earth at (0,0)</p>
</dd>
<dt class="field-odd">Kword highres<span class="colon">:</span></dt>
<dd class="field-odd"><p>Creates the image in high resolution, scaled up by this value (suitable for print).</p>
</dd>
<dt class="field-even">Kword draw<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to anything but None or False in order to draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-odd">Kword noborder<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot figure edge-to-edge without borders (default off)</p>
</dd>
<dt class="field-even">Kword noxlabels<span class="colon">:</span></dt>
<dd class="field-even"><p>Suppress x-axis labels and title</p>
</dd>
<dt class="field-odd">Kword noylabels<span class="colon">:</span></dt>
<dd class="field-odd"><p>Suppress y-axis labels and title</p>
</dd>
<dt class="field-even">Kword scale<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale text size (default=1.0)</p>
</dd>
<dt class="field-odd">Kword thick<span class="colon">:</span></dt>
<dd class="field-odd"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-even">Kword nocb<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to suppress drawing of colourbar</p>
</dd>
<dt class="field-odd">Kword internalcb<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to draw colorbar inside plot instead of outside. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword external<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional function to use for external plotting of e.g. contours. The function
receives the following arguments: ax, XmeshXY,YmeshXY, pass_maps
If the function accepts a fifth variable, if set to true, it is expected to 
return a list of required variables for constructing the pass_maps dictionary.</p>
</dd>
<dt class="field-odd">Kword expression<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional function which calculates a custom expression to plot. The function
receives the same dictionary of numpy arrays as external, as an argument pass_maps,
the contents of which are maps of variables. Each is either of size [ysize,xsize]
or for multi-dimensional variables (vectors, tensors) it‚Äôs [ysize,xsize,dim].
If the function accepts a second variable, if set to true, it is expected to 
return a list of required variables for pass_maps.</p>
</dd>
<dt class="field-even">Kword diff<span class="colon">:</span></dt>
<dd class="field-even"><p>Instead of a regular plot, plot the difference between the selected plot type for
the regular source file and the file given by this keyword. This overides external
and expression keywords, as well as related pass_vars, pass_times, and pass_full.</p>
</dd>
</dl>
<p>Important note: the dictionaries of arrays passed to external and expression are of shape [ysize,xzize], so
for some analysis transposing them is necessary. For pre-existing functions to use and to base new functions
on, see the plot_helpers.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword vscale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale all values with this before plotting. Useful for going from e.g. m^-3 to cm^-3
or from tesla to nanotesla. Guesses correct units for colourbar for some known
variables. Set to None to search for a default scaling settings.</p>
</dd>
<dt class="field-even">Kword absolute<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot the absolute of the evaluated variable</p>
</dd>
<dt class="field-odd">Kword pass_vars<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional list of map names to pass to the external/expression functions 
as a dictionary of numpy arrays. Each is either of size [ysize,xsize] or 
for multi-dimensional variables (vectors, tensors) it‚Äôs [ysize,xsize,dim].</p>
</dd>
<dt class="field-even">Kword pass_times<span class="colon">:</span></dt>
<dd class="field-even"><p>Integer, how many timesteps in each direction should be passed to external/expression
functions in pass_vars (e.g. pass_times=1 passes the values of three timesteps). If
pass_times has two values, the first is the extent before, the second after.
(e.g. pass_times=[2,1] passes the values of two preceding and one following timesteps
for a total of four timesteps)
This causes pass_vars to become a list of timesteps, with each timestep containing
a dictionary of numpy arrays as for regular pass_vars. An additional dictionary entry is
added as ‚Äòdstep‚Äô which gives the timestep offset from the master frame.
Does not work if working from a vlsv-object.</p>
</dd>
<dt class="field-odd">Kword pass_full<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to anything but None in order to pass the full arrays instead of a zoomed-in section</p>
</dd>
<dt class="field-even">Kword fluxfile<span class="colon">:</span></dt>
<dd class="field-even"><p>Filename to plot fluxfunction from</p>
</dd>
<dt class="field-odd">Kword flux_levels<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of flux function values to plot as the contours (default: None, a set of constant 
intervals: np.linspace(-10,10,fluxlines*60))</p>
</dd>
<dt class="field-even">Kword fluxdir<span class="colon">:</span></dt>
<dd class="field-even"><p>Directory in which fluxfunction files can be found</p>
</dd>
<dt class="field-odd">Kword fluxthick<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale fluxfunction line thickness</p>
</dd>
<dt class="field-even">Kword fluxlines<span class="colon">:</span></dt>
<dd class="field-even"><p>Relative density of fluxfunction contours</p>
</dd>
<dt class="field-odd">Kword fluxlinecolor<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set flux line color (default black)</p>
</dd>
<dt class="field-even">Kword fsaved<span class="colon">:</span></dt>
<dd class="field-even"><p>Overplot locations of fSaved. If keyword is set to a string, that will be the colour used.</p>
</dd>
<dt class="field-odd">Kword nomask<span class="colon">:</span></dt>
<dd class="field-odd"><p>Do not mask plotting based on proton density</p>
</dd>
<dt class="field-even">Kword vectors<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to a vector variable to overplot (unit length vectors, color displays variable magnitude)</p>
</dd>
<dt class="field-odd">Kword vectordensity<span class="colon">:</span></dt>
<dd class="field-odd"><p>Aim for how many vectors to show in plot window (default 100)</p>
</dd>
<dt class="field-even">Kword vectorcolormap<span class="colon">:</span></dt>
<dd class="field-even"><p>Colormap to use for overplotted vectors (default: gray)</p>
</dd>
<dt class="field-odd">Kword vectorsize<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scaling of vector sizes</p>
</dd>
<dt class="field-even">Kword streamlines<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to a vector variable to overplot as streamlines</p>
</dd>
<dt class="field-odd">Kword streamlinedensity<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set streamline density (default 1)</p>
</dd>
<dt class="field-even">Kword streamlinecolor<span class="colon">:</span></dt>
<dd class="field-even"><p>Set streamline color (default white)</p>
</dd>
<dt class="field-odd">Kword streamlinethick<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set streamline thickness</p>
</dd>
<dt class="field-even">Kword axes<span class="colon">:</span></dt>
<dd class="field-even"><p>Provide the routine a set of axes to draw within instead of generating a new image.
It is recommended to either also provide cbaxes or activate nocb, unless one wants a colorbar
to be automatically added next to the panel (but this may affect the overall layout)
Note that the aspect ratio of the colormap is made equal in any case, hence the axes
proportions may change if the box and axes size are not designed to match by the user</p>
</dd>
<dt class="field-odd">Kword cbaxes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Provide the routine a set of axes for the colourbar.</p>
</dd>
<dt class="field-even">Kword useimshow<span class="colon">:</span></dt>
<dd class="field-even"><p>Use imshow for raster background instead (default: False)</p>
</dd>
<dt class="field-odd">Kword imshowinterp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use this matplotlib interpolation for imshow (default: ‚Äònone‚Äô)</p>
</dd>
<dt class="field-even">Kword flipxaxis<span class="colon">:</span></dt>
<dd class="field-even"><p>Invert output plot x/horizontal axis so that e.g. the Sun is on the left (default: False)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Outputs an image to a file or to the screen.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example usage:</span>
<span class="n">plot_colormap</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fileLocation</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;MA&quot;</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="s2">&quot;BCQ&quot;</span><span class="p">,</span>
            <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="n">outputLocation</span><span class="p">,</span>
            <span class="n">lin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wmark</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">2.7</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
            <span class="n">external</span><span class="o">=</span><span class="n">cavitoncontours</span><span class="p">,</span> <span class="n">pass_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="c1"># Where cavitoncontours is an external function which receives the arguments</span>
<span class="c1">#  ax, XmeshXY,YmeshXY, pass_maps</span>
<span class="c1"># where pass_maps is a dictionary of maps for the requested variables.</span>

<span class="c1"># example (simple) use of expressions:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">exprMA_cust</span><span class="p">(</span><span class="n">exprmaps</span><span class="p">,</span> <span class="n">requestvariables</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">requestvariables</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">]</span>
    <span class="n">custombulkspeed</span><span class="o">=</span><span class="mf">750000.</span> <span class="c1"># m/s</span>
    <span class="n">va</span> <span class="o">=</span> <span class="n">exprmaps</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">][:,:]</span>
    <span class="n">MA</span> <span class="o">=</span> <span class="n">custombulkspeed</span><span class="o">/</span><span class="n">va</span>
    <span class="k">return</span> <span class="n">MA</span>
<span class="n">plot_colormap</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fileLocation</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="n">exprMA_cust</span><span class="p">,</span><span class="n">lin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_colormap3dslice">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_colormap3dslice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usesci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internalcb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noborder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noxlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noylabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsaved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsavedlinewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsavedcolour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsavedlinestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'solid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxrope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxropelinewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxropecolour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxropelinestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amrlinewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amrcolours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amrlinestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nomask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Earth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectordensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorcolormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinedensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinethick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutpointre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flipxaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useimshow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imshowinterp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_colormap3dslice" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a coloured plot with axes and a colour bar, slicing through a 3D domain. Currently only supports axis-
aligned slices.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword run<span class="colon">:</span></dt>
<dd class="field-odd"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-even">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-even"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final part will be used as a prefix for the files.</p>
</dd>
<dt class="field-odd">Kword outputfile<span class="colon">:</span></dt>
<dd class="field-odd"><p>Singular output file name</p>
</dd>
<dt class="field-even">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-odd">Kword var<span class="colon">:</span></dt>
<dd class="field-odd"><p>variable to plot, e.g. rho, RhoBackstream, beta, Temperature, MA, Mms, va, vms,
E, B, v, V or others. Accepts any variable known by analysator.
Per-population variables are simply given as ‚Äúproton/rho‚Äù etc</p>
</dd>
<dt class="field-even">Kword operator<span class="colon">:</span></dt>
<dd class="field-even"><p>Operator to apply to variable: None, x, y, or z. Vector variables return either
the queried component, or otherwise the magnitude.</p>
</dd>
<dt class="field-odd">Kword op<span class="colon">:</span></dt>
<dd class="field-odd"><p>duplicate of operator</p>
</dd>
<dt class="field-even">Kword boxm<span class="colon">:</span></dt>
<dd class="field-even"><p>zoom box extents [x0,x1,y0,y1] in metres (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-odd">Kword boxre<span class="colon">:</span></dt>
<dd class="field-odd"><p>zoom box extents [x0,x1,y0,y1] in Earth radii (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-even">Kword colormap<span class="colon">:</span></dt>
<dd class="field-even"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-odd">Kword title<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-even">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as colorbar title instead of map name</p>
</dd>
<dt class="field-odd">Kword axisunit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot axes using 10^{axisunit} m (default: Earth radius R_E)</p>
</dd>
<dt class="field-even">Kword tickinterval<span class="colon">:</span></dt>
<dd class="field-even"><p>Interval at which to have ticks on axes (not colorbar)</p>
</dd>
<dt class="field-odd">Kwird usesci<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use scientific notation for colorbar ticks? (default: True)</p>
</dd>
<dt class="field-even">Kword vmin,vmax<span class="colon">:</span></dt>
<dd class="field-even"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot (non-zero rho regions only) are used.</p>
</dd>
<dt class="field-odd">Kword symmetric<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set the absolute value of vmin and vmax to the greater of the two</p>
</dd>
<dt class="field-even">Kword lin<span class="colon">:</span></dt>
<dd class="field-even"><p>Flag for using linear colour scaling instead of log</p>
</dd>
<dt class="field-odd">Kword symlog<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use logarithmic scaling, but linear when abs(value) is below the value given to symlog.
Allows symmetric quasi-logarithmic plots of e.g. transverse field components.
A given of 0 translates to a threshold of max(abs(vmin),abs(vmax)) * 1.e-2, but this can
result in the innermost tick marks overlapping. In this case, using a larger value for 
symlog is suggested.</p>
</dd>
<dt class="field-even">Kword wmark<span class="colon">:</span></dt>
<dd class="field-even"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-odd">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-odd"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
<dt class="field-even">Kword Earth<span class="colon">:</span></dt>
<dd class="field-even"><p>If set, draws an earth at (0,0)</p>
</dd>
<dt class="field-odd">Kword highres<span class="colon">:</span></dt>
<dd class="field-odd"><p>Creates the image in high resolution, scaled up by this value (suitable for print).</p>
</dd>
<dt class="field-even">Kword draw<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to nonzero in order to draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-odd">Kword noborder<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot figure edge-to-edge without borders (default off)</p>
</dd>
<dt class="field-even">Kword noxlabels<span class="colon">:</span></dt>
<dd class="field-even"><p>Suppress x-axis labels and title</p>
</dd>
<dt class="field-odd">Kword noylabels<span class="colon">:</span></dt>
<dd class="field-odd"><p>Suppress y-axis labels and title</p>
</dd>
<dt class="field-even">Kword scale<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale text size (default=1.0)</p>
</dd>
<dt class="field-odd">Kword thick<span class="colon">:</span></dt>
<dd class="field-odd"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-even">Kword nocb<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to suppress drawing of colourbar</p>
</dd>
<dt class="field-odd">Kword internalcb<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to draw colorbar inside plot instead of outside. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword external<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional function to use for external plotting of e.g. contours. The function
receives the following arguments: ax, XmeshXY,YmeshXY, pass_maps
If the function accepts a fifth variable, if set to true, it is expected to 
return a list of required variables for constructing the pass_maps dictionary.</p>
</dd>
<dt class="field-odd">Kword expression<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional function which calculates a custom expression to plot. The function
receives the same dictionary of numpy arrays as external, as an argument pass_maps,
the contents of which are maps of variables. Each is either of size [ysize,xsize]
or for multi-dimensional variables (vectors, tensors) it‚Äôs [ysize,xsize,dim].
If the function accepts a second variable, if set to true, it is expected to 
return a list of required variables for pass_maps.</p>
</dd>
</dl>
<p>Important note: the dictionaries of arrays passed to external and expression are of shape [ysize,xzize], so
for some analysis transposing them is necessary. For pre-existing functions to use and to base new functions
on, see the plot_helpers.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword vscale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale all values with this before plotting. Useful for going from e.g. m^-3 to cm^-3
or from tesla to nanotesla. Guesses correct units for colourbar for some known
variables. Set to None to seek for a default scaling.</p>
</dd>
<dt class="field-even">Kword absolute<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot the absolute of the evaluated variable</p>
</dd>
<dt class="field-odd">Kword pass_vars<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional list of map names to pass to the external/expression functions 
as a dictionary of numpy arrays. Each is either of size [ysize,xsize] or 
for multi-dimensional variables (vectors, tensors) it‚Äôs [ysize,xsize,dim].</p>
</dd>
<dt class="field-even">Kword pass_times<span class="colon">:</span></dt>
<dd class="field-even"><p>Integer, how many timesteps in each direction should be passed to external/expression
functions in pass_vars (e.g. pass_times=1 passes the values of three timesteps). If
pass_times has two values, the first is the extent before, the second after.
(e.g. pass_times=[2,1] passes the values of two preceding and one following timesteps
for a total of four timesteps)
This causes pass_vars to become a list of timesteps, with each timestep containing
a dictionary of numpy arrays as for regular pass_vars. An additional dictionary entry is
added as ‚Äòdstep‚Äô which gives the timestep offset from the master frame.
Does not work if working from a vlsv-object.</p>
</dd>
<dt class="field-odd">Kword pass_full<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to anything but None in order to pass the full arrays instead of a zoomed-in section</p>
</dd>
<dt class="field-even">Kword diff<span class="colon">:</span></dt>
<dd class="field-even"><p>Instead of a regular plot, plot the difference between the selected plot type for
the regular source file and the file given by this keyword. This overides external
and expression keywords, as well as related pass_vars, pass_times, and pass_full.</p>
</dd>
<dt class="field-odd">Kword fsaved<span class="colon">:</span></dt>
<dd class="field-odd"><p>Overplot locations of fSaved. If keyword is set to a string, that will be the colour used.</p>
</dd>
<dt class="field-even">Kword fsavedlinewidth<span class="colon">:</span></dt>
<dd class="field-even"><p>Line width for fSaved markers, default 0.5.</p>
</dd>
<dt class="field-odd">Kword fsavedlinestyle<span class="colon">:</span></dt>
<dd class="field-odd"><p>Line style of fSaved markers, default ‚Äúsolid‚Äù.</p>
</dd>
<dt class="field-even">Kword fluxrope<span class="colon">:</span></dt>
<dd class="field-even"><p>Overplot a contour of where vg_fluxrope is under the cutoff value given in this variable.
The contour follows the AMR cell edges.</p>
</dd>
<dt class="field-odd">Kword fluxropelinewidth<span class="colon">:</span></dt>
<dd class="field-odd"><p>Line width of fluxrope contour, default 0.5.</p>
</dd>
<dt class="field-even">Kword fluxropecolour<span class="colon">:</span></dt>
<dd class="field-even"><p>Colour of fluxrope contour, default ‚Äúblack‚Äù.</p>
</dd>
<dt class="field-odd">Kword fluxropelinestyle<span class="colon">:</span></dt>
<dd class="field-odd"><p>Line style of fluxrope contour, default ‚Äúsolid‚Äù.</p>
</dd>
<dt class="field-even">Kword amr<span class="colon">:</span></dt>
<dd class="field-even"><p>Overplot contours of AMR levels given as a tuple in this argument. The contours follow the AMR cell edges.</p>
</dd>
<dt class="field-odd">Kword amrlinewidths<span class="colon">:</span></dt>
<dd class="field-odd"><p>Line widths of AMR contours, default 0.5. If a single value it is applied to all contours,
otherwise given as a tuple of same length as kword amr.</p>
</dd>
<dt class="field-even">Kword amrcolours<span class="colon">:</span></dt>
<dd class="field-even"><p>Colours of AMR contour, default ‚Äúblack‚Äù. If a single value is given, it is applied to all contours,
otherwise given as a tuple of same length as kword amr.</p>
</dd>
<dt class="field-odd">Kword amrlinestyles<span class="colon">:</span></dt>
<dd class="field-odd"><p>Line styles of AMR contours, default ‚Äúsolid‚Äù. If a single value is given, it is applied to all contours,  
otherwise given as a tuple of same length as kword amr.</p>
</dd>
<dt class="field-even">Kword nomask<span class="colon">:</span></dt>
<dd class="field-even"><p>Do not mask plotting based on proton density</p>
</dd>
<dt class="field-odd">Kword vectors<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to a vector variable to overplot (unit length vectors, color displays variable magnitude)</p>
</dd>
<dt class="field-even">Kword vectordensity<span class="colon">:</span></dt>
<dd class="field-even"><p>Aim for how many vectors to show in plot window (default 100)</p>
</dd>
<dt class="field-odd">Kword vectorcolormap<span class="colon">:</span></dt>
<dd class="field-odd"><p>Colormap to use for overplotted vectors (default: gray)</p>
</dd>
<dt class="field-even">Kword vectorsize<span class="colon">:</span></dt>
<dd class="field-even"><p>Scaling of vector sizes</p>
</dd>
<dt class="field-odd">Kword streamlines<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to a vector variable to overplot as streamlines</p>
</dd>
<dt class="field-even">Kword streamlinedensity<span class="colon">:</span></dt>
<dd class="field-even"><p>Set streamline density (default 1)</p>
</dd>
<dt class="field-odd">Kword streamlinecolor<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set streamline color (default white)</p>
</dd>
<dt class="field-even">Kword streamlinethick<span class="colon">:</span></dt>
<dd class="field-even"><p>Set streamline thickness</p>
</dd>
<dt class="field-odd">Kword axes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Provide the routine a set of axes to draw within instead of generating a new image.
It is recommended to either also provide cbaxes or activate nocb, unless one wants a colorbar
to be automatically added next to the panel (but this may affect the overall layout)
Note that the aspect ratio of the colormap is made equal in any case, hence the axes
proportions may change if the box and axes size are not designed to match by the user</p>
</dd>
<dt class="field-even">Kword cbaxes<span class="colon">:</span></dt>
<dd class="field-even"><p>Provide the routine a set of axes for the colourbar.</p>
</dd>
<dt class="field-odd">Kword normal<span class="colon">:</span></dt>
<dd class="field-odd"><p>Direction of the normal of the 2D cut through (‚Äòx‚Äô, ‚Äòy‚Äô, or ‚Äòz‚Äô or a vector along x,y, or z)</p>
</dd>
<dt class="field-even">Kword cutpoint<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinate (in normal direction) through which the cut must pass [m]</p>
</dd>
<dt class="field-odd">Kword cutpointre<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinate (in normal direction) through which the cut must pass [rE]</p>
</dd>
<dt class="field-even">Kword flipxaxis<span class="colon">:</span></dt>
<dd class="field-even"><p>Invert output plot x/horizontal axis so that e.g. the Sun is on the left (default: False)</p>
</dd>
<dt class="field-odd">Kword useimshow<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use imshow for raster background instead (default: False)</p>
</dd>
<dt class="field-even">Kword imshowinterp<span class="colon">:</span></dt>
<dd class="field-even"><p>Use this matplotlib interpolation for imshow (default: ‚Äònone‚Äô)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Outputs an image to a file or to the screen.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example usage:</span>
<span class="n">plot_colormap</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fileLocation</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;MA&quot;</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="s2">&quot;BCQ&quot;</span><span class="p">,</span>
            <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="n">outputLocation</span><span class="p">,</span>
            <span class="n">lin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wmark</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">2.7</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
            <span class="n">external</span><span class="o">=</span><span class="n">cavitoncontours</span><span class="p">,</span> <span class="n">pass_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="c1"># Where cavitoncontours is an external function which receives the arguments</span>
<span class="c1">#  ax, XmeshXY,YmeshXY, pass_maps</span>
<span class="c1"># where pass_maps is a dictionary of maps for the requested variables.</span>

<span class="c1"># example (simple) use of expressions:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">exprMA_cust</span><span class="p">(</span><span class="n">exprmaps</span><span class="p">,</span> <span class="n">requestvariables</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">requestvariables</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">]</span>
    <span class="n">custombulkspeed</span><span class="o">=</span><span class="mf">750000.</span> <span class="c1"># m/s</span>
    <span class="n">va</span> <span class="o">=</span> <span class="n">exprmaps</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">][:,:]</span>
    <span class="n">MA</span> <span class="o">=</span> <span class="n">custombulkspeed</span><span class="o">/</span><span class="n">va</span>
    <span class="k">return</span> <span class="n">MA</span>
<span class="n">plot_colormap</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fileLocation</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="n">exprMA_cust</span><span class="p">,</span><span class="n">lin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_ionosphere">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_ionosphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usesci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internalcb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minlatitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_ionosphere" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a 2d projection of an ionosphere variable</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword run<span class="colon">:</span></dt>
<dd class="field-odd"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-even">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-even"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final part will be used as a prefix for the files.</p>
</dd>
<dt class="field-odd">Kword outputfile<span class="colon">:</span></dt>
<dd class="field-odd"><p>Singular output file name</p>
</dd>
<dt class="field-even">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-odd">Kword var<span class="colon">:</span></dt>
<dd class="field-odd"><p>variable to plot, e.g. rho, RhoBackstream, beta, Temperature, MA, Mms, va, vms,
E, B, v, V or others. Accepts any variable known by analysator.
Per-population variables are simply given as ‚Äúproton/rho‚Äù etc</p>
</dd>
<dt class="field-even">Kword operator<span class="colon">:</span></dt>
<dd class="field-even"><p>Operator to apply to variable: None, x, y, or z. Vector variables return either
the queried component, or otherwise the magnitude.</p>
</dd>
<dt class="field-odd">Kword op<span class="colon">:</span></dt>
<dd class="field-odd"><p>duplicate of operator</p>
</dd>
<dt class="field-even">Kword colormap<span class="colon">:</span></dt>
<dd class="field-even"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-odd">Kword vmin,vmax<span class="colon">:</span></dt>
<dd class="field-odd"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot (non-zero rho regions only) are used.</p>
</dd>
<dt class="field-even">Kword symmetric<span class="colon">:</span></dt>
<dd class="field-even"><p>Set the absolute value of vmin and vmax to the greater of the two</p>
</dd>
<dt class="field-odd">Kword absolute<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot the absolute of the evaluated variable</p>
</dd>
<dt class="field-even">Kwird usesci<span class="colon">:</span></dt>
<dd class="field-even"><p>Use scientific notation for colorbar ticks? (default: True)</p>
</dd>
<dt class="field-odd">Kword lin<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flag for using linear colour scaling instead of log</p>
</dd>
<dt class="field-even">Kword symlog<span class="colon">:</span></dt>
<dd class="field-even"><p>Use logarithmic scaling, but linear when abs(value) is below the value given to symlog.
Allows symmetric quasi-logarithmic plots of e.g. transverse field components.
A given of 0 translates to a threshold of max(abs(vmin),abs(vmax)) * 1.e-2, but this can
result in the innermost tick marks overlapping. In this case, using a larger value for 
symlog is suggested.</p>
</dd>
<dt class="field-odd">Kword nocb<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to suppress drawing of colourbar</p>
</dd>
<dt class="field-even">Kword internalcb<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to draw colorbar inside plot instead of outside. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-odd">Kword minlatitude<span class="colon">:</span></dt>
<dd class="field-odd"><p>Minimum plot latitude (default=60 degrees)</p>
</dd>
<dt class="field-even">Kword title<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-odd">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as colorbar title instead of map name</p>
</dd>
<dt class="field-even">Kword viewdir<span class="colon">:</span></dt>
<dd class="field-even"><p>view direction onto the sphere. Positive value: North pole. Negative values: South pole.</p>
</dd>
<dt class="field-odd">Kword scale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale text size (default=1.0)</p>
</dd>
<dt class="field-even">Kword vscale<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale all values with this before plotting. Useful for going from e.g. m^-3 to cm^-3
or from tesla to nanotesla. Guesses correct units for colourbar for some known
variables.</p>
</dd>
<dt class="field-odd">Kword axes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Provide the routine a set of axes to draw within instead of generating a new image.</p>
</dd>
<dt class="field-even">Kword cbaxes<span class="colon">:</span></dt>
<dd class="field-even"><p>Provide the routine a set of axes for the colourbar.</p>
</dd>
<dt class="field-odd">Kword thick<span class="colon">:</span></dt>
<dd class="field-odd"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-even">Kword draw<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to anything but None or False in order to draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-odd">Kword wmark<span class="colon">:</span></dt>
<dd class="field-odd"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-even"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_isosurface">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_isosurface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usesci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[30.0,</span> <span class="pre">90.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_isosurface" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a coloured isosurface plot with axes and a colour bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final parti will be used as a perfix for the files.</p>
</dd>
<dt class="field-even">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-odd">Kword surf_var<span class="colon">:</span></dt>
<dd class="field-odd"><p>Variable to read for defining surface</p>
</dd>
<dt class="field-even">Kword surf_op<span class="colon">:</span></dt>
<dd class="field-even"><p>Operator to use for variable to read surface</p>
</dd>
<dt class="field-odd">Kword surf_level<span class="colon">:</span></dt>
<dd class="field-odd"><p>Level at which to define surface</p>
</dd>
<dt class="field-even">Kword surf_step<span class="colon">:</span></dt>
<dd class="field-even"><p>Vertex stepping for surface generation: larger value returns coarser surface</p>
</dd>
<dt class="field-odd">Kword color_var<span class="colon">:</span></dt>
<dd class="field-odd"><p>Variable to read for coloring surface</p>
</dd>
<dt class="field-even">Kword color_op<span class="colon">:</span></dt>
<dd class="field-even"><p>Operator to use for variable to color surface (‚Äòx‚Äô, ‚Äòy‚Äô, ‚Äòz‚Äô; if None and color_var is a vector, the magnitude is taken)</p>
</dd>
<dt class="field-odd">Kword boxm<span class="colon">:</span></dt>
<dd class="field-odd"><p>zoom box extents [x0,x1,y0,y1] in metres (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-even">Kword boxre<span class="colon">:</span></dt>
<dd class="field-even"><p>zoom box extents [x0,x1,y0,y1] in Earth radii (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-odd">Kword colormap<span class="colon">:</span></dt>
<dd class="field-odd"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-even">Kword run<span class="colon">:</span></dt>
<dd class="field-even"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-odd">Kword title<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as plot title instead of time</p>
</dd>
<dt class="field-even">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as colorbar title instead of map name</p>
</dd>
<dt class="field-odd">Kword unit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot axes using 10^{unit} m (default: Earth radius R_E)</p>
</dd>
<dt class="field-even">Kwird usesci<span class="colon">:</span></dt>
<dd class="field-even"><p>Use scientific notation for colorbar ticks? (default: 1)</p>
</dd>
<dt class="field-odd">Kword vscale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale all values with this before plotting. Useful for going from e.g. m^-3 to cm^-3
or from tesla to nanotesla. Guesses correct units for colourbar for some known
variables. Set to None to seek for a default scaling.</p>
</dd>
<dt class="field-even">Kword vmin,vmax<span class="colon">:</span></dt>
<dd class="field-even"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot (non-zero rho regions only) are used.</p>
</dd>
<dt class="field-odd">Kword symmetric<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set the absolute value of vmin and vmax to the greater of the two</p>
</dd>
<dt class="field-even">Kword lin<span class="colon">:</span></dt>
<dd class="field-even"><p>Flag for using linear colour scaling instead of log</p>
</dd>
<dt class="field-odd">Kword symlog<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use logarithmic scaling, but linear when abs(value) is below the value given to symlog.
Allows symmetric quasi-logarithmic plots of e.g. transverse field components.
A given of 0 translates to a threshold of max(abs(vmin),abs(vmax)) * 1.e-2.</p>
</dd>
<dt class="field-even">Kword wmark<span class="colon">:</span></dt>
<dd class="field-even"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner.</p>
</dd>
<dt class="field-odd">Kword highres<span class="colon">:</span></dt>
<dd class="field-odd"><p>Creates the image in high resolution, scaled up by this value (suitable for logging.info).</p>
</dd>
<dt class="field-even">Kword draw<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to nonzero in order to draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-odd">Kword transparent<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to False in order to make the surface opaque</p>
</dd>
<dt class="field-even">Kword scale<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale text size (default=1.0)</p>
</dd>
<dt class="field-odd">Kword thick<span class="colon">:</span></dt>
<dd class="field-odd"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-even">Kword nocb<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to suppress drawing of colourbar</p>
</dd>
<dt class="field-odd">Kword angle<span class="colon">:</span></dt>
<dd class="field-odd"><p>Viewing elevation and azimuthal angles in degrees</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Outputs an image to a file or to the screen.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p># Example usage:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_multiple_variables">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_multiple_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables_x_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_y_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_xticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_multiple_variables" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots multiple variables from the input with pylab</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables_x_list</strong> ‚Äì Some list of variables to be plotted in the x-axis</p></li>
<li><p><strong>variables_y_list</strong> ‚Äì Some list of variables to be plotted in the y-axis</p></li>
<li><p><strong>figure</strong> ‚Äì If one wants to plot into an existing figure then the matplotlib figure should be passed as an argument (OPTIONAL)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a pylab figure with the plot</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example usage:</span>
<span class="n">plot_multiple_variables</span><span class="p">(</span> <span class="p">[</span><span class="n">distances</span><span class="p">,</span> <span class="n">xcoordinates</span><span class="p">],</span> <span class="p">[</span><span class="n">rho</span><span class="p">,</span> <span class="n">B_x</span><span class="p">]</span> <span class="p">)</span>
<span class="c1"># This would plot rho_values as a function of distance and B_x_values as a function of xcoordinates</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiplot expects variables to be saved in the VariableInfo class</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If for some reason some variable list (x or y) is empty, e.g. variables_x_list = [B_x, [], B_z, rho], then the variable will not be plotted. This can be used if one wants to plot only into certain subplots.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_neutral_sheet">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_neutral_sheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usesci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internalcb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noborder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noxlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noylabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nomask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Earth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectordensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorcolormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinedensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">streamlinethick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useimshow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imshowinterp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folding_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-5,</span> <span class="pre">5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheetlayer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'above'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_neutral_sheet" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a coloured plot along the neutral sheet with axes and a colour bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword run<span class="colon">:</span></dt>
<dd class="field-odd"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-even">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-even"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final part will be used as a prefix for the files.</p>
</dd>
<dt class="field-odd">Kword outputfile<span class="colon">:</span></dt>
<dd class="field-odd"><p>Singular output file name</p>
</dd>
<dt class="field-even">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-odd">Kword var<span class="colon">:</span></dt>
<dd class="field-odd"><p>variable to plot, e.g. rho, RhoBackstream, beta, Temperature, MA, Mms, va, vms,
E, B, v, V or others. Accepts any variable known by analysator.
Per-population variables are simply given as ‚Äúproton/rho‚Äù etc</p>
</dd>
<dt class="field-even">Kword operator<span class="colon">:</span></dt>
<dd class="field-even"><p>Operator to apply to variable: None, x, y, or z. Vector variables return either
the queried component, or otherwise the magnitude.</p>
</dd>
<dt class="field-odd">Kword op<span class="colon">:</span></dt>
<dd class="field-odd"><p>duplicate of operator</p>
</dd>
<dt class="field-even">Kword boxm<span class="colon">:</span></dt>
<dd class="field-even"><p>zoom box extents [x0,x1,y0,y1] in metres (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-odd">Kword boxre<span class="colon">:</span></dt>
<dd class="field-odd"><p>zoom box extents [x0,x1,y0,y1] in Earth radii (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-even">Kword colormap<span class="colon">:</span></dt>
<dd class="field-even"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-odd">Kword title<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-even">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as colorbar title instead of map name</p>
</dd>
<dt class="field-odd">Kword axisunit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot axes using 10^{axisunit} m (default: Earth radius R_E)</p>
</dd>
<dt class="field-even">Kword tickinterval<span class="colon">:</span></dt>
<dd class="field-even"><p>Interval at which to have ticks on axes (not colorbar)</p>
</dd>
<dt class="field-odd">Kwird usesci<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use scientific notation for colorbar ticks? (default: True)</p>
</dd>
<dt class="field-even">Kword vmin,vmax<span class="colon">:</span></dt>
<dd class="field-even"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot (non-zero rho regions only) are used.</p>
</dd>
<dt class="field-odd">Kword symmetric<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set the absolute value of vmin and vmax to the greater of the two</p>
</dd>
<dt class="field-even">Kword lin<span class="colon">:</span></dt>
<dd class="field-even"><p>Flag for using linear colour scaling instead of log</p>
</dd>
<dt class="field-odd">Kword symlog<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use logarithmic scaling, but linear when abs(value) is below the value given to symlog.
Allows symmetric quasi-logarithmic plots of e.g. transverse field components.
A given of 0 translates to a threshold of max(abs(vmin),abs(vmax)) * 1.e-2, but this can
result in the innermost tick marks overlapping. In this case, using a larger value for 
symlog is suggested.</p>
</dd>
<dt class="field-even">Kword wmark<span class="colon">:</span></dt>
<dd class="field-even"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-odd">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-odd"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
<dt class="field-even">Kword Earth<span class="colon">:</span></dt>
<dd class="field-even"><p>If set, draws an earth at (0,0)</p>
</dd>
<dt class="field-odd">Kword highres<span class="colon">:</span></dt>
<dd class="field-odd"><p>Creates the image in high resolution, scaled up by this value (suitable for print).</p>
</dd>
<dt class="field-even">Kword draw<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to nonzero in order to draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-odd">Kword noborder<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot figure edge-to-edge without borders (default off)</p>
</dd>
<dt class="field-even">Kword noxlabels<span class="colon">:</span></dt>
<dd class="field-even"><p>Suppress x-axis labels and title</p>
</dd>
<dt class="field-odd">Kword noylabels<span class="colon">:</span></dt>
<dd class="field-odd"><p>Suppress y-axis labels and title</p>
</dd>
<dt class="field-even">Kword scale<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale text size (default=1.0)</p>
</dd>
<dt class="field-odd">Kword thick<span class="colon">:</span></dt>
<dd class="field-odd"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-even">Kword nocb<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to suppress drawing of colourbar</p>
</dd>
<dt class="field-odd">Kword internalcb<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to draw colorbar inside plot instead of outside. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword external<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional function to use for external plotting of e.g. contours. The function
receives the following arguments: ax, XmeshXY,YmeshXY, pass_maps
If the function accepts a fifth variable, if set to true, it is expected to 
return a list of required variables for constructing the pass_maps dictionary.</p>
</dd>
<dt class="field-odd">Kword expression<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional function which calculates a custom expression to plot. The function
receives the same dictionary of numpy arrays as external, as an argument pass_maps,
the contents of which are maps of variables. Each is either of size [ysize,xsize]
or for multi-dimensional variables (vectors, tensors) it‚Äôs [ysize,xsize,dim].
If the function accepts a second variable, if set to true, it is expected to 
return a list of required variables for pass_maps.</p>
</dd>
</dl>
<p>Important note: the dictionaries of arrays passed to external and expression are of shape [ysize,xzize], so
for some analysis transposing them is necessary. For pre-existing functions to use and to base new functions
on, see the plot_helpers.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword vscale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale all values with this before plotting. Useful for going from e.g. m^-3 to cm^-3
or from tesla to nanotesla. Guesses correct units for colourbar for some known
variables. Set to None to seek for a default scaling.</p>
</dd>
<dt class="field-even">Kword absolute<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot the absolute of the evaluated variable</p>
</dd>
<dt class="field-odd">Kword pass_vars<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional list of map names to pass to the external/expression functions 
as a dictionary of numpy arrays. Each is either of size [ysize,xsize] or 
for multi-dimensional variables (vectors, tensors) it‚Äôs [ysize,xsize,dim].</p>
</dd>
<dt class="field-even">Kword pass_times<span class="colon">:</span></dt>
<dd class="field-even"><p>Integer, how many timesteps in each direction should be passed to external/expression
functions in pass_vars (e.g. pass_times=1 passes the values of three timesteps). If
pass_times has two values, the first is the extent before, the second after.
(e.g. pass_times=[2,1] passes the values of two preceding and one following timesteps
for a total of four timesteps)
This causes pass_vars to become a list of timesteps, with each timestep containing
a dictionary of numpy arrays as for regular pass_vars. An additional dictionary entry is
added as ‚Äòdstep‚Äô which gives the timestep offset from the master frame.
Does not work if working from a vlsv-object.</p>
</dd>
<dt class="field-odd">Kword pass_full<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to anything but None in order to pass the full arrays instead of a zoomed-in section</p>
</dd>
<dt class="field-even">Kword diff<span class="colon">:</span></dt>
<dd class="field-even"><p>Instead of a regular plot, plot the difference between the selected plot type for
the regular source file and the file given by this keyword. This overides external
and expression keywords, as well as related pass_vars, pass_times, and pass_full.</p>
</dd>
<dt class="field-odd">Kword z_extent<span class="colon">:</span></dt>
<dd class="field-odd"><p>Search bracket for the neutral sheet in axisunit units</p>
</dd>
<dt class="field-even">Kword folding_alpha<span class="colon">:</span></dt>
<dd class="field-even"><p>If non-zero, plots transparent dots over the regions where the sheet has multiple separate z-values. A value of 1.0 is opaque, a value of 0.0 is transparent.</p>
</dd>
<dt class="field-odd">Kword sheetlayer<span class="colon">:</span></dt>
<dd class="field-odd"><p>If set to ‚Äòabove‚Äô, plots the topmost layer of the neutral sheet in case of folding. If set to anything else, 
the downmost layer is plotted.</p>
</dd>
<dt class="field-even">Kword nomask<span class="colon">:</span></dt>
<dd class="field-even"><p>Do not mask plotting based on proton density</p>
</dd>
<dt class="field-odd">Kword vectors<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to a vector variable to overplot (unit length vectors, color displays variable magnitude)</p>
</dd>
<dt class="field-even">Kword vectordensity<span class="colon">:</span></dt>
<dd class="field-even"><p>Aim for how many vectors to show in plot window (default 100)</p>
</dd>
<dt class="field-odd">Kword vectorcolormap<span class="colon">:</span></dt>
<dd class="field-odd"><p>Colormap to use for overplotted vectors (default: gray)</p>
</dd>
<dt class="field-even">Kword vectorsize<span class="colon">:</span></dt>
<dd class="field-even"><p>Scaling of vector sizes</p>
</dd>
<dt class="field-odd">Kword streamlines<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to a vector variable to overplot as streamlines</p>
</dd>
<dt class="field-even">Kword streamlinedensity<span class="colon">:</span></dt>
<dd class="field-even"><p>Set streamline density (default 1)</p>
</dd>
<dt class="field-odd">Kword streamlinecolor<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set streamline color (default white)</p>
</dd>
<dt class="field-even">Kword streamlinethick<span class="colon">:</span></dt>
<dd class="field-even"><p>Set streamline thickness</p>
</dd>
<dt class="field-odd">Kword axes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Provide the routine a set of axes to draw within instead of generating a new image.
It is recommended to either also provide cbaxes or activate nocb, unless one wants a colorbar
to be automatically added next to the panel (but this may affect the overall layout)
Note that the aspect ratio of the colormap is made equal in any case, hence the axes
proportions may change if the box and axes size are not designed to match by the user</p>
</dd>
<dt class="field-even">Kword cbaxes<span class="colon">:</span></dt>
<dd class="field-even"><p>Provide the routine a set of axes for the colourbar.</p>
</dd>
<dt class="field-odd">Kword normal<span class="colon">:</span></dt>
<dd class="field-odd"><p>Direction of the normal of the 2D cut through (‚Äòx‚Äô, ‚Äòy‚Äô, or ‚Äòz‚Äô or a vector)</p>
</dd>
<dt class="field-even">Kword cutpoint<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinate (in normal direction) through which the cut must pass [m]</p>
</dd>
<dt class="field-odd">Kword cutpointre<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinate (in normal direction) through which the cut must pass [rE]</p>
</dd>
<dt class="field-even">Kword useimshow<span class="colon">:</span></dt>
<dd class="field-even"><p>Use imshow for raster background instead (default: False)</p>
</dd>
<dt class="field-odd">Kword imshowinterp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use this matplotlib interpolation for imshow (default: ‚Äònone‚Äô)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Outputs an image to a file or to the screen.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example usage:</span>
<span class="n">plot_colormap</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fileLocation</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;MA&quot;</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="s2">&quot;BCQ&quot;</span><span class="p">,</span>
            <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="n">outputLocation</span><span class="p">,</span>
            <span class="n">lin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wmark</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">2.7</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
            <span class="n">external</span><span class="o">=</span><span class="n">cavitoncontours</span><span class="p">,</span> <span class="n">pass_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="c1"># Where cavitoncontours is an external function which receives the arguments</span>
<span class="c1">#  ax, XmeshXY,YmeshXY, pass_maps</span>
<span class="c1"># where pass_maps is a dictionary of maps for the requested variables.</span>

<span class="c1"># example (simple) use of expressions:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">exprMA_cust</span><span class="p">(</span><span class="n">exprmaps</span><span class="p">,</span> <span class="n">requestvariables</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">requestvariables</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">]</span>
    <span class="n">custombulkspeed</span><span class="o">=</span><span class="mf">750000.</span> <span class="c1"># m/s</span>
    <span class="n">va</span> <span class="o">=</span> <span class="n">exprmaps</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">][:,:]</span>
    <span class="n">MA</span> <span class="o">=</span> <span class="n">custombulkspeed</span><span class="o">/</span><span class="n">va</span>
    <span class="k">return</span> <span class="n">MA</span>
<span class="n">plot_colormap</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fileLocation</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="n">exprMA_cust</span><span class="p">,</span><span class="n">lin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_threeslice">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_threeslice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usesci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axiscolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixedticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nomask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Earth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-60.0,</span> <span class="pre">30.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutpointm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutpointre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_threeslice" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a 3d plot constructed of three 2d cut throughs.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword run<span class="colon">:</span></dt>
<dd class="field-odd"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-even">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-even"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final part will be used as a prefix for the files.</p>
</dd>
<dt class="field-odd">Kword outputfile<span class="colon">:</span></dt>
<dd class="field-odd"><p>Singular output file name</p>
</dd>
<dt class="field-even">Kword draw<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to anything but None or False in order to draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-odd">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-even">Kword var<span class="colon">:</span></dt>
<dd class="field-even"><p>variable to plot, e.g. rho, RhoBackstream, beta, Temperature, MA, Mms, va, vms,
E, B, v, V or others. Accepts any variable known by analysator.
Per-population variables are simply given as ‚Äúproton/rho‚Äù etc</p>
</dd>
<dt class="field-odd">Kword operator<span class="colon">:</span></dt>
<dd class="field-odd"><p>Operator to apply to variable: None, x, y, or z. Vector variables return either
the queried component, or otherwise the magnitude.</p>
</dd>
<dt class="field-even">Kword op<span class="colon">:</span></dt>
<dd class="field-even"><p>duplicate of operator</p>
</dd>
<dt class="field-odd">Kword boxm<span class="colon">:</span></dt>
<dd class="field-odd"><p>zoom box extents [x0,x1,y0,y1,z0,z1] in metres (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-even">Kword boxre<span class="colon">:</span></dt>
<dd class="field-even"><p>zoom box extents [x0,x1,y0,y1,z0,z1] in Earth radii (default and truncate to: whole simulation box)</p>
</dd>
<dt class="field-odd">Kword colormap<span class="colon">:</span></dt>
<dd class="field-odd"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-even">Kword vmin,vmax<span class="colon">:</span></dt>
<dd class="field-even"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot (non-zero rho regions only) are used.</p>
</dd>
<dt class="field-odd">Kword symmetric<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set the absolute value of vmin and vmax to the greater of the two</p>
</dd>
<dt class="field-even">Kword absolute<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot the absolute of the evaluated variable</p>
</dd>
<dt class="field-odd">Kword lin<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flag for using linear colour scaling instead of log</p>
</dd>
<dt class="field-even">Kword symlog<span class="colon">:</span></dt>
<dd class="field-even"><p>Use logarithmic scaling, but linear when abs(value) is below the value given to symlog.
Allows symmetric quasi-logarithmic plots of e.g. transverse field components.
A given of 0 translates to a threshold of max(abs(vmin),abs(vmax)) * 1.e-2, but this can
result in the innermost tick marks overlapping. In this case, using a larger value for 
symlog is suggested.</p>
</dd>
<dt class="field-odd">Kword nocb<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to suppress drawing of colourbar</p>
</dd>
<dt class="field-even">Kword title<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-odd">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as colorbar title instead of map name</p>
</dd>
<dt class="field-even">Kword halfaxes<span class="colon">:</span></dt>
<dd class="field-even"><p>Flag to prevent plotting the hidden half of the axes, otherwise shown as dashed lines
(default: False)</p>
</dd>
<dt class="field-odd">Kwird usesci<span class="colon">:</span></dt>
<dd class="field-odd"><p>Use scientific notation for colorbar ticks? (default: True)</p>
</dd>
<dt class="field-even">Kword axisunit<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot axes using 10^{axisunit} m (default: Earth radius R_E)</p>
</dd>
<dt class="field-odd">Kword axiscolor<span class="colon">:</span></dt>
<dd class="field-odd"><p>Color for drawing axes (default black)</p>
</dd>
<dt class="field-even">Kword shadings<span class="colon">:</span></dt>
<dd class="field-even"><p>Dimming values for the surfaces normal to the X, Y, Z directions, respectively,
to better distinguish the slices, e.g. ‚Äú(0.6,0.8,1.0). Default using the angles between
the surface normal directions and the viewing angle.</p>
</dd>
<dt class="field-odd">Kword tickinterval:Axis tick interval, expressed in 10^{axisunit} (default<span class="colon">:</span></dt>
<dd class="field-odd"><p>10 Earth radii)</p>
</dd>
<dt class="field-even">Kword fixedticks<span class="colon">:</span></dt>
<dd class="field-even"><p>Set ticks at fixed locations instead of relative to the triple cut point (default: False)</p>
</dd>
<dt class="field-odd">Kword pass_full<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to anything but None in order to pass the full arrays instead of a zoomed-in section</p>
</dd>
<dt class="field-even">Kword wmark<span class="colon">:</span></dt>
<dd class="field-even"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-odd">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-odd"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
<dt class="field-even">Kword nomask<span class="colon">:</span></dt>
<dd class="field-even"><p>Do not mask plotting based on proton density</p>
</dd>
<dt class="field-odd">Kword Earth<span class="colon">:</span></dt>
<dd class="field-odd"><p>Draw Earth at origin (default True)</p>
</dd>
<dt class="field-even">Kword scale<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale text size (default=1.0)</p>
</dd>
<dt class="field-odd">Kword thick<span class="colon">:</span></dt>
<dd class="field-odd"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-even">Kword expression<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional function which calculates a custom expression to plot. The function
receives the same dictionary of numpy arrays as external, as an argument pass_maps,
the contents of which are maps of variables. Each is either of size [ysize,xsize]
or for multi-dimensional variables (vectors, tensors) it‚Äôs [ysize,xsize,dim].
If the function accepts a second variable, if set to true, it is expected to 
return a list of required variables for pass_maps.</p>
</dd>
</dl>
<p>Important note: the dictionaries of arrays passed to external and expression are of shape [ysize,xzize], so
for some analysis transposing them is necessary. For pre-existing functions to use and to base new functions
on, see the plot_helpers.py file.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword vscale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale all values with this before plotting. Useful for going from e.g. m^-3 to cm^-3
or from tesla to nanotesla. Guesses correct units for colourbar for some known
variables. Set to None to search for a default scaling.</p>
</dd>
<dt class="field-even">Kword viewangle<span class="colon">:</span></dt>
<dd class="field-even"><p>Azimuth and elevation angles giving the point of view on the 3D axes, in degrees.
(default=(-60.,30.); corresponds to dayside, morningside, northern hemisphere)</p>
</dd>
<dt class="field-odd">Kword cutpointm<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinates of the point through which all three 2D cuts must pass [m]</p>
</dd>
<dt class="field-even">Kword cutpointre<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinates of the point through which all three 2D cuts must pass [rE]</p>
</dd>
<dt class="field-odd">Kword slices<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normal directions of the slices to plot, default=‚Äôxyz‚Äô</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_variables">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_variables" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots x and y variables from the input with pylab</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> ‚Äì Some variable to be plotted in the x-axis</p></li>
<li><p><strong>y</strong> ‚Äì Some variable to be plotted in the y-axis</p></li>
<li><p><strong>figure</strong> ‚Äì If one wants to plot into an existing figure then the matplotlib figure should be passed as an argument (OPTIONAL)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a pylab figure with the plot</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example usage:</span>
<span class="n">plot_variables</span><span class="p">(</span> <span class="n">distances</span><span class="p">,</span> <span class="n">rho</span> <span class="p">)</span>
<span class="c1"># This would plot rho as a function of distance</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_vdf">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_vdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'proton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axiskmps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internalcb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicethick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'integrate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpara</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpara1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bperp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordswap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bvector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bvectorscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbulk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpeak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wflux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noborder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biglabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biglabloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noxlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noylabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_vdf" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots a coloured 2D plot of a VDF (a slice of given thickness or fully projected) with axes and a colour bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final parti will be used as a perfix for the files.</p>
</dd>
<dt class="field-even">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-odd">Kword cellids<span class="colon">:</span></dt>
<dd class="field-odd"><p>LIST of cell IDs to plot VDF for</p>
</dd>
<dt class="field-even">Kword coordinates<span class="colon">:</span></dt>
<dd class="field-even"><p>LIST of 3-element spatial coordinate lusts to plot VDF for (given in metres)</p>
</dd>
<dt class="field-odd">Kword coordre<span class="colon">:</span></dt>
<dd class="field-odd"><p>LIST of 3-element spatial coordinate lists to plot VDF for (given in Earth radii)</p>
</dd>
<dt class="field-even">Kword pop<span class="colon">:</span></dt>
<dd class="field-even"><p>Population to plot, default proton</p>
</dd>
<dt class="field-odd">Kword colormap<span class="colon">:</span></dt>
<dd class="field-odd"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-even">Kword run<span class="colon">:</span></dt>
<dd class="field-even"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-odd">Kword title<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-even">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as colorbar title instead of phase space density of flux</p>
</dd>
<dt class="field-odd">Kword contours<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to number of contours to draw</p>
</dd>
<dt class="field-even">Kword fmin,fmax<span class="colon">:</span></dt>
<dd class="field-even"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot are used.</p>
</dd>
<dt class="field-odd">Kword box<span class="colon">:</span></dt>
<dd class="field-odd"><p>extents of plotted velocity grid as [x0,x1,y0,y1] (in m/s)</p>
</dd>
<dt class="field-even">Kword axisunit<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot v-axes using 10^{axisunit} m/s (default: km/s)</p>
</dd>
<dt class="field-odd">Kword axiskmps<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot v-axes using 10^{axiskmps} km/s (default: km/s, when the kword has a value)</p>
</dd>
<dt class="field-even">Kword tickinterval<span class="colon">:</span></dt>
<dd class="field-even"><p>Interval at which to have ticks on axes</p>
</dd>
<dt class="field-odd">Kword xy<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in x-y-direction</p>
</dd>
<dt class="field-even">Kword xz<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in x-z-direction</p>
</dd>
<dt class="field-odd">Kword yz<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in y-z-direction</p>
</dd>
<dt class="field-even">Kword normal<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in plane perpendicular to given vector</p>
</dd>
<dt class="field-odd">Kword normalx<span class="colon">:</span></dt>
<dd class="field-odd"><p>X-axis direction for slice in plane perpendicular to given vector</p>
</dd>
<dt class="field-even">Kword bpara<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in B_para / B_perp2 plane</p>
</dd>
<dt class="field-odd">Kword bpara1<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in B_para / B_perp1 plane</p>
</dd>
<dt class="field-even">Kword bperp<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in B_perp1 / B_perp2 plane
If no plane is given, default is simulation plane (for 2D simulations)</p>
</dd>
<dt class="field-odd">Kword coordswap<span class="colon">:</span></dt>
<dd class="field-odd"><p>Swap the parallel and perpendicular coordinates</p>
</dd>
<dt class="field-even">Kword bvector<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot a magnetic field vector projection in-plane</p>
</dd>
<dt class="field-odd">Kword bvectorscale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale of bvector (default: 0.2 in units of axis lengths)</p>
</dd>
<dt class="field-even">Kword cbulk<span class="colon">:</span></dt>
<dd class="field-even"><p>Center plot on position of total bulk velocity (or if not available,
bulk velocity for this population)</p>
</dd>
<dt class="field-odd">Kword cpeak<span class="colon">:</span></dt>
<dd class="field-odd"><p>Center plot on velocity associated with highest (peak) phase-space density for
this population)</p>
</dd>
<dt class="field-even">Kword center<span class="colon">:</span></dt>
<dd class="field-even"><p>Center plot on provided 3-element velocity vector position (in m/s)
If set instead to ‚Äúbulk‚Äù will center on bulk velocity
If set instead to ‚Äúpeak‚Äù will center on velocity with highest phase-space density</p>
</dd>
<dt class="field-odd">Kword wflux<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot flux instead of distribution function</p>
</dd>
<dt class="field-even">Kword slicethick<span class="colon">:</span></dt>
<dd class="field-even"><p>Thickness of slice as multiplier of cell size (default: 1 or minimum for good coverage).
This can be set to zero in order to project the whole VDF to a plane.</p>
</dd>
<dt class="field-odd">Kword reducer<span class="colon">:</span></dt>
<dd class="field-odd"><p>How to reduce to 2D - default ‚Äòintegrate‚Äô for LOS integration
and reduced units, ‚Äòaverage‚Äô for old (slightly questionable) behaviour</p>
</dd>
<dt class="field-even">Kword resampler<span class="colon">:</span></dt>
<dd class="field-even"><p>Resample onto a regular grid? Default: yes, use False to disable.</p>
</dd>
<dt class="field-odd">Kword cellsize<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plotting grid cell size as multiplier of input cell size (default: 1 or minimum for good coverage)</p>
</dd>
<dt class="field-even">Kword setThreshold<span class="colon">:</span></dt>
<dd class="field-even"><p>Use given setThreshold value instead of EffectiveSparsityThreshold or MinValue value read from file
Useful if EffectiveSparsityThreshold wasn‚Äôt saved, or user wants to draw buffer cells
with values below the sparsity threshold</p>
</dd>
<dt class="field-odd">Kword wmark<span class="colon">:</span></dt>
<dd class="field-odd"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-even"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
<dt class="field-odd">Kword draw<span class="colon">:</span></dt>
<dd class="field-odd"><p>Draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-even">Kword nocb<span class="colon">:</span></dt>
<dd class="field-even"><p>Suppress plotting of colourbar legend</p>
</dd>
<dt class="field-odd">Kword internalcb<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to draw colorbar inside plot instead of outside. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword biglabel<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot large label (in top-left corner)</p>
</dd>
<dt class="field-odd">Kword biglabloc<span class="colon">:</span></dt>
<dd class="field-odd"><p>Move large label to: 0: NW 1: NE 2: SE 3: SW corner</p>
</dd>
<dt class="field-even">Kword axes<span class="colon">:</span></dt>
<dd class="field-even"><p>Provide the routine a set of axes to draw within instead of generating a new image.</p>
</dd>
<dt class="field-odd">Kword cbaxes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Provide the routine a set of axes for the colourbar.</p>
</dd>
<dt class="field-even">Kword noborder<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot figure edge-to-edge without borders (default off)</p>
</dd>
<dt class="field-odd">Kword noxlabels<span class="colon">:</span></dt>
<dd class="field-odd"><p>Suppress x-axis labels and title</p>
</dd>
<dt class="field-even">Kword noylabels<span class="colon">:</span></dt>
<dd class="field-even"><p>Suppress y-axis labels and title</p>
</dd>
<dt class="field-odd">Kword scale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale text size everywhere (default=1.0)</p>
</dd>
<dt class="field-even">Kword scale_text<span class="colon">:</span></dt>
<dd class="field-even"><p>Most text additional scale factor (default=8.0)</p>
</dd>
<dt class="field-odd">Kword scale_title<span class="colon">:</span></dt>
<dd class="field-odd"><p>Title additional scale factor (default=10.0)</p>
</dd>
<dt class="field-even">Kword scale_cb<span class="colon">:</span></dt>
<dd class="field-even"><p>Colour bar text additional scale factor (default=5.0)</p>
</dd>
<dt class="field-odd">Kword scale_label<span class="colon">:</span></dt>
<dd class="field-odd"><p>Big label text additional scale factor (default=12.0)</p>
</dd>
<dt class="field-even">Kword thick<span class="colon">:</span></dt>
<dd class="field-even"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Outputs an image to a file or to the screen.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p># Example usage:</p>
<dl class="simple">
<dt>pt.plot.plot_vdf(filename=‚Äù/proj/vlasov/2D/ABC/distributions/distributions.0000100.vlsv‚Äù,</dt><dd><p>coordre=[[11.7,-1.6,0.]], cbulk=1, bpara=1,box=[-2e6,2e6,-2e6,2e6],draw=1)</p>
</dd>
<dt>pt.plot.plot_vdf(filename=‚Äù/proj/vlasov/2D/ABC/distributions/distributions.0000100.vlsv‚Äù,</dt><dd><p>cellids=1670561, xy=1, box=[-2e6,2e6,-2e6,2e6], slicethick=5)</p>
</dd>
<dt>pt.plot.plot_vdf(filename=‚Äù/proj/vlasov/2D/ABC/distributions/distributions.0000100.vlsv‚Äù,</dt><dd><p>cellids=[1670561,], xz=1, box=[-2e6,2e6,-2e6,2e6], slicethick=0)</p>
</dd>
</dl>
<p>Note tilted slices: By default, the program samples the V-space with a slice where each cell is cube the
dimensions of which are found by performing a rotation on a sample square and finding the maximum xyz-extent. This ensures
adequate coverage and decreases sampling effects. This behaviour can be overridden with the slicethick and cellsize keywords.</p>
<p>Setting a value of slicethick=0 will result in the whole VDF being flattened into a single plane. This may result in
some slight sampling artefacts, but is a good measure of complex populations.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_vdf_profiles">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_vdf_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'proton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpara</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpara1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bperp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbulk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpeak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_vdf_profiles" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots vdf values along axis-aligned lines (see axis definitions).</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword vlsvobj<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final parti will be used as a perfix for the files.</p>
</dd>
<dt class="field-even">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-odd">Kword cellids<span class="colon">:</span></dt>
<dd class="field-odd"><p>LIST of cell IDs to plot VDF for</p>
</dd>
<dt class="field-even">Kword coordinates<span class="colon">:</span></dt>
<dd class="field-even"><p>LIST of 3-element spatial coordinate lusts to plot VDF for (given in metres)</p>
</dd>
<dt class="field-odd">Kword coordre<span class="colon">:</span></dt>
<dd class="field-odd"><p>LIST of 3-element spatial coordinate lists to plot VDF for (given in Earth radii)</p>
</dd>
<dt class="field-even">Kword pop<span class="colon">:</span></dt>
<dd class="field-even"><p>Population to plot, default proton</p>
</dd>
<dt class="field-odd">Kword run<span class="colon">:</span></dt>
<dd class="field-odd"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-even">Kword title<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-odd">Kword fmin,fmax<span class="colon">:</span></dt>
<dd class="field-odd"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot are used.</p>
</dd>
<dt class="field-even">Kword vmin,vmax<span class="colon">:</span></dt>
<dd class="field-even"><p>min and max values for x-axis</p>
</dd>
<dt class="field-odd">Kword axisunit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot v-axes using 10^{axisunit} m/s (default: km/s)</p>
</dd>
<dt class="field-even">Kword tickinterval<span class="colon">:</span></dt>
<dd class="field-even"><p>Interval at which to have ticks on axes</p>
</dd>
<dt class="field-odd">Kword lin<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot using linear y-axis (default log)</p>
</dd>
<dt class="field-even">Kword xy<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in x-y-direction</p>
</dd>
<dt class="field-odd">Kword xz<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in x-z-direction</p>
</dd>
<dt class="field-even">Kword yz<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in y-z-direction</p>
</dd>
<dt class="field-odd">Kword normal<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in plane perpendicular to given vector</p>
</dd>
<dt class="field-even">Kword bpara<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in B_para / B_perp2 plane</p>
</dd>
<dt class="field-odd">Kword bpara1<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in B_para / B_perp1 plane</p>
</dd>
<dt class="field-even">Kword bperp<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in B_perp1 / B_perp2 plane
If no plane is given, default is simulation plane (for 2D simulations)</p>
</dd>
<dt class="field-odd">Kword cbulk<span class="colon">:</span></dt>
<dd class="field-odd"><p>Center plot on position of total bulk velocity (or if not available,
bulk velocity for this population)</p>
</dd>
<dt class="field-even">Kword cpeak<span class="colon">:</span></dt>
<dd class="field-even"><p>Center plot on velocity with highest phase-space density</p>
</dd>
<dt class="field-odd">Kword center<span class="colon">:</span></dt>
<dd class="field-odd"><p>Center plot on provided 3-element velocity vector position (in m/s)
If set instead to ‚Äúbulk‚Äù will center on bulk velocity
If set instead to ‚Äúpeak‚Äù will center on velocity with highest phase-space density</p>
</dd>
<dt class="field-even">Kword setThreshold<span class="colon">:</span></dt>
<dd class="field-even"><p>Use given setThreshold value instead of EffectiveSparsityThreshold or MinValue value read from file
Useful if EffectiveSparsityThreshold wasn‚Äôt saved, or user wants to draw buffer cells
with values below the sparsity threshold</p>
</dd>
<dt class="field-odd">Kword wmark<span class="colon">:</span></dt>
<dd class="field-odd"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-even"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
<dt class="field-odd">Kword draw<span class="colon">:</span></dt>
<dd class="field-odd"><p>Draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-even">Kword axes<span class="colon">:</span></dt>
<dd class="field-even"><p>Provide the routine a set of axes to draw within instead of generating a new image.</p>
</dd>
<dt class="field-odd">Kword scale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale text size (default=1.0)</p>
</dd>
<dt class="field-even">Kword thick<span class="colon">:</span></dt>
<dd class="field-even"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Outputs an image to a file or to the screen.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p># Example usage:</p>
<dl class="simple">
<dt>pt.plot.plot_vdf(filename=‚Äù/proj/vlasov/2D/ABC/distributions/distributions.0000100.vlsv‚Äù,</dt><dd><p>coordre=[[11.7,-1.6,0.]], cbulk=1, bpara=1,box=[-2e6,2e6,-2e6,2e6],draw=1)</p>
</dd>
<dt>pt.plot.plot_vdf(filename=‚Äù/proj/vlasov/2D/ABC/distributions/distributions.0000100.vlsv‚Äù,</dt><dd><p>cellids=1670561, xy=1, box=[-2e6,2e6,-2e6,2e6], slicethick=5)</p>
</dd>
<dt>pt.plot.plot_vdf(filename=‚Äù/proj/vlasov/2D/ABC/distributions/distributions.0000100.vlsv‚Äù,</dt><dd><p>cellids=[1670561,], xz=1, box=[-2e6,2e6,-2e6,2e6], slicethick=0)</p>
</dd>
</dl>
<p>Note tilted slices: By default, the program samples the V-space with a slice where each cell is cube the
dimensions of which are found by performing a rotation on a sample square and finding the maximum xyz-extent. This ensures
adequate coverage and decreases sampling effects. This behaviour can be overridden with the slicethick and cellsize keywords.</p>
<p>Setting a value of slicethick=0 will result in the whole VDF being flattened into a single plane. This may result in
some slight sampling artefacts, but is a good measure of complex populations.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysator.plot.plot_vdfdiff">
<span class="sig-prename descclassname"><span class="pre">analysator.plot.</span></span><span class="sig-name descname"><span class="pre">plot_vdfdiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlsvobj2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellids2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'proton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nooverwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axiskmps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internalcb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmarkb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicethick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'integrate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpara</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpara1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bperp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordswap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bvector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bvectorscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbulk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wflux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noborder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biglabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biglabloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noxlabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noylabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysator.plot.plot_vdfdiff" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Plots the difference between VDFs as a coloured 2D plot with axes and a colour bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Kword filename1<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-even">Kword filename2<span class="colon">:</span></dt>
<dd class="field-even"><p>path to .vlsv file to use for input. Assumes a bulk file.</p>
</dd>
<dt class="field-odd">Kword vlsvobj1<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-even">Kword vlsvobj2<span class="colon">:</span></dt>
<dd class="field-even"><p>Optionally provide a python vlsvfile object instead</p>
</dd>
<dt class="field-odd">Kword filedir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optionally provide directory where files are located and use step for bulk file name</p>
</dd>
<dt class="field-even">Kword step<span class="colon">:</span></dt>
<dd class="field-even"><p>output step index, used for constructing output (and possibly input) filename</p>
</dd>
<dt class="field-odd">Kword outputdir<span class="colon">:</span></dt>
<dd class="field-odd"><p>path to directory where output files are created (default: $HOME/Plots/ or override with PTOUTPUTDIR)
If directory does not exist, it will be created. If the string does not end in a
forward slash, the final parti will be used as a perfix for the files.</p>
</dd>
<dt class="field-even">Kword nooverwrite<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to only perform actions if the target output file does not yet exist</p>
</dd>
<dt class="field-odd">Kword cellids<span class="colon">:</span></dt>
<dd class="field-odd"><p>LIST of cell IDs to plot VDF for</p>
</dd>
<dt class="field-even">Kword cellids2<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional: LIST of cell IDs from input file 2. Same as cellids if omitted.</p>
</dd>
<dt class="field-odd">Kword coordinates<span class="colon">:</span></dt>
<dd class="field-odd"><p>LIST of 3-element spatial coordinate lusts to plot VDF for (given in metres)</p>
</dd>
<dt class="field-even">Kword coordre<span class="colon">:</span></dt>
<dd class="field-even"><p>LIST of 3-element spatial coordinate lists to plot VDF for (given in Earth radii)</p>
</dd>
<dt class="field-odd">Kword pop<span class="colon">:</span></dt>
<dd class="field-odd"><p>Population to plot, default proton</p>
</dd>
<dt class="field-even">Kword colormap<span class="colon">:</span></dt>
<dd class="field-even"><p>colour scale for plot, use e.g. hot_desaturated, jet, viridis, plasma, inferno,
magma, parula, nipy_spectral, RdBu, bwr</p>
</dd>
<dt class="field-odd">Kword run<span class="colon">:</span></dt>
<dd class="field-odd"><p>run identifier, used for constructing output filename</p>
</dd>
<dt class="field-even">Kword title<span class="colon">:</span></dt>
<dd class="field-even"><p>string to use as plot title instead of time.
Special case: Set to ‚Äúmsec‚Äù to plot time with millisecond accuracy or ‚Äúmusec‚Äù
for microsecond accuracy. ‚Äúsec‚Äù is integer second accuracy.</p>
</dd>
<dt class="field-odd">Kword cbtitle<span class="colon">:</span></dt>
<dd class="field-odd"><p>string to use as colorbar title instead of phase space density of flux</p>
</dd>
<dt class="field-even">Kword contours<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to number of contours to draw</p>
</dd>
<dt class="field-odd">Kword fmin,fmax<span class="colon">:</span></dt>
<dd class="field-odd"><p>min and max values for colour scale and colour bar. If no values are given,
min and max values for whole plot are used.</p>
</dd>
<dt class="field-even">Kword box<span class="colon">:</span></dt>
<dd class="field-even"><p>extents of plotted velocity grid as [x0,x1,y0,y1] (in m/s)</p>
</dd>
<dt class="field-odd">Kword axisunit<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot v-axes using 10^{axisunit} m/s (default: km/s)</p>
</dd>
<dt class="field-even">Kword axiskmps<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot v-axes using 10^{axiskmps} km/s (default: km/s, when the kword has a value)</p>
</dd>
<dt class="field-odd">Kword tickinterval<span class="colon">:</span></dt>
<dd class="field-odd"><p>Interval at which to have ticks on axes</p>
</dd>
<dt class="field-even">Kword xy<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in x-y-direction</p>
</dd>
<dt class="field-odd">Kword xz<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in x-z-direction</p>
</dd>
<dt class="field-even">Kword yz<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in y-z-direction</p>
</dd>
<dt class="field-odd">Kword normal<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in plane perpendicular to given vector</p>
</dd>
<dt class="field-even">Kword normalx<span class="colon">:</span></dt>
<dd class="field-even"><p>X-axis direction for slice in plane perpendicular to given vector</p>
</dd>
<dt class="field-odd">Kword bpara<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in B_para / B_perp2 plane</p>
</dd>
<dt class="field-even">Kword bpara1<span class="colon">:</span></dt>
<dd class="field-even"><p>Perform slice in B_para / B_perp1 plane</p>
</dd>
<dt class="field-odd">Kword bperp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Perform slice in B_perp1 / B_perp2 plane
If no plane is given, default is simulation plane (for 2D simulations)</p>
</dd>
<dt class="field-even">Kword coordswap<span class="colon">:</span></dt>
<dd class="field-even"><p>Swap the parallel and perpendicular coordinates</p>
</dd>
<dt class="field-odd">Kword bvector<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot a magnetic field vector projection in-plane</p>
</dd>
<dt class="field-even">Kword bvectorscale<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale of bvector (default: 0.2 in units of axis lengths)</p>
</dd>
<dt class="field-odd">Kword cbulk<span class="colon">:</span></dt>
<dd class="field-odd"><p>Center plot on position of total bulk velocity (or if not available,
bulk velocity for this population)</p>
</dd>
<dt class="field-even">Kword center<span class="colon">:</span></dt>
<dd class="field-even"><p>Center plot on provided 3-element velocity vector position (in m/s)
If set instead to ‚Äúbulk‚Äù will center on bulk velocity
If set instead to ‚Äúpeak‚Äù will center on velocity with highest phase-space density</p>
</dd>
<dt class="field-odd">Kword wflux<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot flux instead of distribution function</p>
</dd>
<dt class="field-even">Kword slicethick<span class="colon">:</span></dt>
<dd class="field-even"><p>Thickness of slice as multiplier of cell size (default: 1 or minimum for good coverage).
This can be set to zero in order to project the whole VDF to a plane.</p>
</dd>
<dt class="field-odd">Kword reducer<span class="colon">:</span></dt>
<dd class="field-odd"><p>How to reduce to 2D - default ‚Äòintegrate‚Äô for LOS integration
and reduced units, ‚Äòaverage‚Äô for old (slightly questionable) behaviour</p>
</dd>
<dt class="field-even">Kword resampler<span class="colon">:</span></dt>
<dd class="field-even"><p>Resample onto a regular grid? Default: yes, use False to disable.</p>
</dd>
<dt class="field-odd">Kword cellsize<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plotting grid cell size as multiplier of input cell size (default: 1 or minimum for good coverage)</p>
</dd>
<dt class="field-even">Kword setThreshold<span class="colon">:</span></dt>
<dd class="field-even"><p>Use given setThreshold value instead of EffectiveSparsityThreshold or MinValue value read from file
Useful if EffectiveSparsityThreshold wasn‚Äôt saved, or user wants to draw buffer cells
with values below the sparsity threshold</p>
</dd>
<dt class="field-odd">Kword wmark<span class="colon">:</span></dt>
<dd class="field-odd"><p>If set to non-zero, will plot a Vlasiator watermark in the top left corner. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword wmarkb<span class="colon">:</span></dt>
<dd class="field-even"><p>As for wmark, but uses an all-black Vlasiator logo.</p>
</dd>
<dt class="field-odd">Kword draw<span class="colon">:</span></dt>
<dd class="field-odd"><p>Draw image on-screen instead of saving to file (requires x-windowing)</p>
</dd>
<dt class="field-even">Kword nocb<span class="colon">:</span></dt>
<dd class="field-even"><p>Suppress plotting of colourbar legend</p>
</dd>
<dt class="field-odd">Kword internalcb<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to draw colorbar inside plot instead of outside. If set to a text
string, tries to use that as the location, e.g. ‚ÄúNW‚Äù,‚ÄùNE‚Äù,‚ÄùSW‚Äù,‚ÄùSW‚Äù</p>
</dd>
<dt class="field-even">Kword biglabel<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot large label (in top-left corner)</p>
</dd>
<dt class="field-odd">Kword biglabloc<span class="colon">:</span></dt>
<dd class="field-odd"><p>Move large label to: 0: NW 1: NE 2: SE 3: SW corner</p>
</dd>
<dt class="field-even">Kword axes<span class="colon">:</span></dt>
<dd class="field-even"><p>Provide the routine a set of axes to draw within instead of generating a new image.</p>
</dd>
<dt class="field-odd">Kword cbaxes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Provide the routine a set of axes for the colourbar.</p>
</dd>
<dt class="field-even">Kword noborder<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot figure edge-to-edge without borders (default off)</p>
</dd>
<dt class="field-odd">Kword noxlabels<span class="colon">:</span></dt>
<dd class="field-odd"><p>Suppress x-axis labels and title</p>
</dd>
<dt class="field-even">Kword noylabels<span class="colon">:</span></dt>
<dd class="field-even"><p>Suppress y-axis labels and title</p>
</dd>
<dt class="field-odd">Kword scale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale text size everywhere (default=1.0)</p>
</dd>
<dt class="field-even">Kword scale_text<span class="colon">:</span></dt>
<dd class="field-even"><p>Most text additional scale factor (default=8.0)</p>
</dd>
<dt class="field-odd">Kword scale_title<span class="colon">:</span></dt>
<dd class="field-odd"><p>Title additional scale factor (default=10.0)</p>
</dd>
<dt class="field-even">Kword scale_cb<span class="colon">:</span></dt>
<dd class="field-even"><p>Colour bar text additional scale factor (default=5.0)</p>
</dd>
<dt class="field-odd">Kword scale_label<span class="colon">:</span></dt>
<dd class="field-odd"><p>Big label text additional scale factor (default=12.0)</p>
</dd>
<dt class="field-even">Kword thick<span class="colon">:</span></dt>
<dd class="field-even"><p>line and axis thickness, default=1.0</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Outputs an image to a file or to the screen.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p># Example usage:</p>
<dl class="simple">
<dt>pt.plot.plot_vdfdiff(‚Äúbulk.0000040.vlsv‚Äù,‚Äùbulk.0000048.vlsv‚Äù,cellids=1,xy=1,slicethick=1,colormap=‚Äùseismic‚Äù,</dt><dd><p>fmin=-1e-9,fmax=1e-9,cbulk=1)</p>
</dd>
</dl>
<p>See documentation of plot_vdf() for more usage information.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../analysator_supported/" class="btn btn-neutral float-left" title="Analysator supported data reducers and vlasiator variables" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../calculations/" class="btn btn-neutral float-right" title="calculations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, University of Helsinki.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>